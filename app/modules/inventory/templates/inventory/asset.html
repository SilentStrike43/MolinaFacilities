{% extends "base.html" %}
{% block body %}
<h5 class="mb-3">Inventory â€” Asset</h5>

<div class="row g-4">
  <div class="col-lg-4">
    <div class="card">
      <div class="card-body">
        <h6 class="fw-semibold mb-3">{{ edit and 'Edit Asset' or 'New Asset' }}</h6>
        <form method="post">
          {% if edit %}
            <input type="hidden" name="_mode" value="update">
            <input type="hidden" name="id" value="{{ edit.id }}">
          {% else %}
            <input type="hidden" name="_mode" value="create">
          {% endif %}

          <div class="mb-2">
            <label class="form-label">Inventory ID</label>
            <input class="form-control" name="InventoryID" value="{{ edit and edit.inventory_id or '' }}" placeholder="{{ next_inv }}">
            <div class="form-text">Leave blank to auto-generate (e.g., {{ next_inv }}).</div>
          </div>

          <div class="row g-2">
            <div class="col-6">
              <label class="form-label">Item Type</label>
              <input class="form-control" name="ItemType" value="{{ edit and edit.item_type or '' }}">
            </div>
            <div class="col-6">
              <label class="form-label">Manufacturer</label>
              <input class="form-control" name="Manufacturer" value="{{ edit and edit.manufacturer or '' }}">
            </div>
          </div>

          <div class="mb-2">
            <label class="form-label">Product Name</label>
            <input class="form-control" name="ProductName" value="{{ edit and edit.product_name or '' }}">
          </div>

          <div class="row g-2">
            <div class="col-6">
              <label class="form-label">Part #</label>
              <input class="form-control" name="PartNumber" value="{{ edit and edit.part_number or '' }}">
            </div>
            <div class="col-6">
              <label class="form-label">Serial #</label>
              <input class="form-control" name="SerialNumber" value="{{ edit and edit.serial_number or '' }}">
            </div>
          </div>

          <div class="row g-2 mt-0">
            <div class="col-6">
              <label class="form-label">Location</label>
              <input class="form-control" name="Location" value="{{ edit and edit.location or '' }}">
            </div>
            <div class="col-6">
              <label class="form-label">Count</label>
              <input class="form-control" name="Count" value="{{ edit and edit.count or 0 }}">
            </div>
          </div>

          <div class="row g-2 mt-0">
            <div class="col-6">
              <label class="form-label">PII</label>
              <input class="form-control" name="PII" value="{{ edit and edit.pii or '' }}">
            </div>
            <div class="col-6">
              <label class="form-label">Status</label>
              <select class="form-select" name="Status">
                <option value="active" {{ (edit and edit.status=='active') and 'selected' or '' }}>Active</option>
                <option value="archived" {{ (edit and edit.status=='archived') and 'selected' or '' }}>Archived</option>
              </select>
            </div>
          </div>

          <div class="mt-2">
            <label class="form-label">Notes</label>
            <textarea class="form-control" name="Notes" rows="2">{{ edit and edit.notes or '' }}</textarea>
          </div>

          {% if not edit %}
          <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" id="pl" name="PrintLabel" value="1">
            <label for="pl" class="form-check-label">Print label after create</label>
          </div>
          {% endif %}

          <div class="mt-3 d-flex gap-2">
            <button class="btn btn-primary">{{ edit and 'Save' or 'Create' }}</button>
            {% if edit %}
              <a class="btn btn-outline-secondary" href="{{ url_for('inventory.asset') }}">Cancel</a>
            {% endif %}
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="col-lg-8">
    <form class="row g-2 mb-2" method="get" action="{{ url_for('inventory.asset') }}">
      <div class="col-md-6"><input class="form-control" name="q" value="{{ q or '' }}" placeholder="Search inventory"></div>
      <div class="col-md-3">
        <select class="form-select" name="status">
          <option value="active" {{ status=='active' and 'selected' or '' }}>Active</option>
          <option value="archived" {{ status=='archived' and 'selected' or '' }}>Archived</option>
        </select>
      </div>
      <div class="col-md-3"><button class="btn btn-primary w-100">Search</button></div>
    </form>

    <div class="table-responsive">
      <table class="table table-sm table-striped align-middle">
        <thead>
          <tr>
            <th>Inv ID</th><th>Product</th><th>Mfr</th><th>SN</th><th class="text-end">Qty</th><th></th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
            <tr>
              <td class="text-nowrap">{{ r.inventory_id }}</td>
              <td>{{ r.product_name }}</td>
              <td>{{ r.manufacturer }}</td>
              <td>{{ r.serial_number }}</td>
              <td class="text-end">{{ r.count }}</td>
              <td class="text-end">
                <a class="btn btn-sm btn-outline-primary" href="{{ url_for('inventory.asset_edit', aid=r.id) }}">Edit</a>
              </td>
            </tr>
          {% endfor %}
          {% if not rows %}
            <tr><td colspan="6" class="text-center text-muted py-4">No assets.</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}